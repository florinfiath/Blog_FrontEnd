{"ast":null,"code":"\"use strict\";\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n  result[\"default\"] = mod;\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar value_types_1 = require(\"./value-types\");\n\nvar MentionSanitizer_1 = require(\"./mentions/MentionSanitizer\");\n\nvar url = __importStar(require(\"./helpers/url\"));\n\nvar funcs_html_1 = require(\"./funcs-html\");\n\nvar array_1 = require(\"./helpers/array\");\n\nvar OpAttributeSanitizer = function () {\n  function OpAttributeSanitizer() {}\n\n  OpAttributeSanitizer.sanitize = function (dirtyAttrs, sanitizeOptions) {\n    var cleanAttrs = {};\n\n    if (!dirtyAttrs || typeof dirtyAttrs !== 'object') {\n      return cleanAttrs;\n    }\n\n    var booleanAttrs = ['bold', 'italic', 'underline', 'strike', 'code', 'blockquote', 'code-block', 'renderAsBlock'];\n    var colorAttrs = ['background', 'color'];\n    var font = dirtyAttrs.font,\n        size = dirtyAttrs.size,\n        link = dirtyAttrs.link,\n        script = dirtyAttrs.script,\n        list = dirtyAttrs.list,\n        header = dirtyAttrs.header,\n        align = dirtyAttrs.align,\n        direction = dirtyAttrs.direction,\n        indent = dirtyAttrs.indent,\n        mentions = dirtyAttrs.mentions,\n        mention = dirtyAttrs.mention,\n        width = dirtyAttrs.width,\n        target = dirtyAttrs.target,\n        rel = dirtyAttrs.rel;\n    var codeBlock = dirtyAttrs['code-block'];\n    var sanitizedAttrs = booleanAttrs.concat(colorAttrs, ['font', 'size', 'link', 'script', 'list', 'header', 'align', 'direction', 'indent', 'mentions', 'mention', 'width', 'target', 'rel', 'code-block']);\n    booleanAttrs.forEach(function (prop) {\n      var v = dirtyAttrs[prop];\n\n      if (v) {\n        cleanAttrs[prop] = !!v;\n      }\n    });\n    colorAttrs.forEach(function (prop) {\n      var val = dirtyAttrs[prop];\n\n      if (val && (OpAttributeSanitizer.IsValidHexColor(val + '') || OpAttributeSanitizer.IsValidColorLiteral(val + '') || OpAttributeSanitizer.IsValidRGBColor(val + ''))) {\n        cleanAttrs[prop] = val;\n      }\n    });\n\n    if (font && OpAttributeSanitizer.IsValidFontName(font + '')) {\n      cleanAttrs.font = font;\n    }\n\n    if (size && OpAttributeSanitizer.IsValidSize(size + '')) {\n      cleanAttrs.size = size;\n    }\n\n    if (width && OpAttributeSanitizer.IsValidWidth(width + '')) {\n      cleanAttrs.width = width;\n    }\n\n    if (link) {\n      cleanAttrs.link = OpAttributeSanitizer.sanitizeLinkUsingOptions(link + '', sanitizeOptions);\n    }\n\n    if (target && OpAttributeSanitizer.isValidTarget(target)) {\n      cleanAttrs.target = target;\n    }\n\n    if (rel && OpAttributeSanitizer.IsValidRel(rel)) {\n      cleanAttrs.rel = rel;\n    }\n\n    if (codeBlock) {\n      if (OpAttributeSanitizer.IsValidLang(codeBlock)) {\n        cleanAttrs['code-block'] = codeBlock;\n      } else {\n        cleanAttrs['code-block'] = !!codeBlock;\n      }\n    }\n\n    if (script === value_types_1.ScriptType.Sub || value_types_1.ScriptType.Super === script) {\n      cleanAttrs.script = script;\n    }\n\n    if (list === value_types_1.ListType.Bullet || list === value_types_1.ListType.Ordered || list === value_types_1.ListType.Checked || list === value_types_1.ListType.Unchecked) {\n      cleanAttrs.list = list;\n    }\n\n    if (Number(header)) {\n      cleanAttrs.header = Math.min(Number(header), 6);\n    }\n\n    if (array_1.find([value_types_1.AlignType.Center, value_types_1.AlignType.Right, value_types_1.AlignType.Justify, value_types_1.AlignType.Left], function (a) {\n      return a === align;\n    })) {\n      cleanAttrs.align = align;\n    }\n\n    if (direction === value_types_1.DirectionType.Rtl) {\n      cleanAttrs.direction = direction;\n    }\n\n    if (indent && Number(indent)) {\n      cleanAttrs.indent = Math.min(Number(indent), 30);\n    }\n\n    if (mentions && mention) {\n      var sanitizedMention = MentionSanitizer_1.MentionSanitizer.sanitize(mention, sanitizeOptions);\n\n      if (Object.keys(sanitizedMention).length > 0) {\n        cleanAttrs.mentions = !!mentions;\n        cleanAttrs.mention = mention;\n      }\n    }\n\n    return Object.keys(dirtyAttrs).reduce(function (cleaned, k) {\n      if (sanitizedAttrs.indexOf(k) === -1) {\n        cleaned[k] = dirtyAttrs[k];\n      }\n\n      return cleaned;\n    }, cleanAttrs);\n  };\n\n  OpAttributeSanitizer.sanitizeLinkUsingOptions = function (link, options) {\n    var sanitizerFn = function () {\n      return undefined;\n    };\n\n    if (options && typeof options.urlSanitizer === 'function') {\n      sanitizerFn = options.urlSanitizer;\n    }\n\n    var result = sanitizerFn(link);\n    return typeof result === 'string' ? result : funcs_html_1.encodeLink(url.sanitize(link));\n  };\n\n  OpAttributeSanitizer.IsValidHexColor = function (colorStr) {\n    return !!colorStr.match(/^#([0-9A-F]{6}|[0-9A-F]{3})$/i);\n  };\n\n  OpAttributeSanitizer.IsValidColorLiteral = function (colorStr) {\n    return !!colorStr.match(/^[a-z]{1,50}$/i);\n  };\n\n  OpAttributeSanitizer.IsValidRGBColor = function (colorStr) {\n    var re = /^rgb\\(((0|25[0-5]|2[0-4]\\d|1\\d\\d|0?\\d?\\d),\\s*){2}(0|25[0-5]|2[0-4]\\d|1\\d\\d|0?\\d?\\d)\\)$/i;\n    return !!colorStr.match(re);\n  };\n\n  OpAttributeSanitizer.IsValidFontName = function (fontName) {\n    return !!fontName.match(/^[a-z\\s0-9\\- ]{1,30}$/i);\n  };\n\n  OpAttributeSanitizer.IsValidSize = function (size) {\n    return !!size.match(/^[a-z0-9\\-]{1,20}$/i);\n  };\n\n  OpAttributeSanitizer.IsValidWidth = function (width) {\n    return !!width.match(/^[0-9]*(px|em|%)?$/);\n  };\n\n  OpAttributeSanitizer.isValidTarget = function (target) {\n    return !!target.match(/^[_a-zA-Z0-9\\-]{1,50}$/);\n  };\n\n  OpAttributeSanitizer.IsValidRel = function (relStr) {\n    return !!relStr.match(/^[a-zA-Z\\s\\-]{1,250}$/i);\n  };\n\n  OpAttributeSanitizer.IsValidLang = function (lang) {\n    if (typeof lang === 'boolean') {\n      return true;\n    }\n\n    return !!lang.match(/^[a-zA-Z\\s\\-\\\\\\/\\+]{1,50}$/i);\n  };\n\n  return OpAttributeSanitizer;\n}();\n\nexports.OpAttributeSanitizer = OpAttributeSanitizer;","map":{"version":3,"sources":["/home/dci/Desktop/Workspace/NoName-People/Backend/BackEndProjects/Blog/Frontend/blog/node_modules/quill-delta-to-html/dist/commonjs/OpAttributeSanitizer.js"],"names":["__importStar","mod","__esModule","result","k","Object","hasOwnProperty","call","defineProperty","exports","value","value_types_1","require","MentionSanitizer_1","url","funcs_html_1","array_1","OpAttributeSanitizer","sanitize","dirtyAttrs","sanitizeOptions","cleanAttrs","booleanAttrs","colorAttrs","font","size","link","script","list","header","align","direction","indent","mentions","mention","width","target","rel","codeBlock","sanitizedAttrs","concat","forEach","prop","v","val","IsValidHexColor","IsValidColorLiteral","IsValidRGBColor","IsValidFontName","IsValidSize","IsValidWidth","sanitizeLinkUsingOptions","isValidTarget","IsValidRel","IsValidLang","ScriptType","Sub","Super","ListType","Bullet","Ordered","Checked","Unchecked","Number","Math","min","find","AlignType","Center","Right","Justify","Left","a","DirectionType","Rtl","sanitizedMention","MentionSanitizer","keys","length","reduce","cleaned","indexOf","options","sanitizerFn","undefined","urlSanitizer","encodeLink","colorStr","match","re","fontName","relStr","lang"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar value_types_1 = require(\"./value-types\");\nvar MentionSanitizer_1 = require(\"./mentions/MentionSanitizer\");\nvar url = __importStar(require(\"./helpers/url\"));\nvar funcs_html_1 = require(\"./funcs-html\");\nvar array_1 = require(\"./helpers/array\");\nvar OpAttributeSanitizer = (function () {\n    function OpAttributeSanitizer() {\n    }\n    OpAttributeSanitizer.sanitize = function (dirtyAttrs, sanitizeOptions) {\n        var cleanAttrs = {};\n        if (!dirtyAttrs || typeof dirtyAttrs !== 'object') {\n            return cleanAttrs;\n        }\n        var booleanAttrs = [\n            'bold',\n            'italic',\n            'underline',\n            'strike',\n            'code',\n            'blockquote',\n            'code-block',\n            'renderAsBlock',\n        ];\n        var colorAttrs = ['background', 'color'];\n        var font = dirtyAttrs.font, size = dirtyAttrs.size, link = dirtyAttrs.link, script = dirtyAttrs.script, list = dirtyAttrs.list, header = dirtyAttrs.header, align = dirtyAttrs.align, direction = dirtyAttrs.direction, indent = dirtyAttrs.indent, mentions = dirtyAttrs.mentions, mention = dirtyAttrs.mention, width = dirtyAttrs.width, target = dirtyAttrs.target, rel = dirtyAttrs.rel;\n        var codeBlock = dirtyAttrs['code-block'];\n        var sanitizedAttrs = booleanAttrs.concat(colorAttrs, [\n            'font',\n            'size',\n            'link',\n            'script',\n            'list',\n            'header',\n            'align',\n            'direction',\n            'indent',\n            'mentions',\n            'mention',\n            'width',\n            'target',\n            'rel',\n            'code-block',\n        ]);\n        booleanAttrs.forEach(function (prop) {\n            var v = dirtyAttrs[prop];\n            if (v) {\n                cleanAttrs[prop] = !!v;\n            }\n        });\n        colorAttrs.forEach(function (prop) {\n            var val = dirtyAttrs[prop];\n            if (val &&\n                (OpAttributeSanitizer.IsValidHexColor(val + '') ||\n                    OpAttributeSanitizer.IsValidColorLiteral(val + '') ||\n                    OpAttributeSanitizer.IsValidRGBColor(val + ''))) {\n                cleanAttrs[prop] = val;\n            }\n        });\n        if (font && OpAttributeSanitizer.IsValidFontName(font + '')) {\n            cleanAttrs.font = font;\n        }\n        if (size && OpAttributeSanitizer.IsValidSize(size + '')) {\n            cleanAttrs.size = size;\n        }\n        if (width && OpAttributeSanitizer.IsValidWidth(width + '')) {\n            cleanAttrs.width = width;\n        }\n        if (link) {\n            cleanAttrs.link = OpAttributeSanitizer.sanitizeLinkUsingOptions(link + '', sanitizeOptions);\n        }\n        if (target && OpAttributeSanitizer.isValidTarget(target)) {\n            cleanAttrs.target = target;\n        }\n        if (rel && OpAttributeSanitizer.IsValidRel(rel)) {\n            cleanAttrs.rel = rel;\n        }\n        if (codeBlock) {\n            if (OpAttributeSanitizer.IsValidLang(codeBlock)) {\n                cleanAttrs['code-block'] = codeBlock;\n            }\n            else {\n                cleanAttrs['code-block'] = !!codeBlock;\n            }\n        }\n        if (script === value_types_1.ScriptType.Sub || value_types_1.ScriptType.Super === script) {\n            cleanAttrs.script = script;\n        }\n        if (list === value_types_1.ListType.Bullet ||\n            list === value_types_1.ListType.Ordered ||\n            list === value_types_1.ListType.Checked ||\n            list === value_types_1.ListType.Unchecked) {\n            cleanAttrs.list = list;\n        }\n        if (Number(header)) {\n            cleanAttrs.header = Math.min(Number(header), 6);\n        }\n        if (array_1.find([value_types_1.AlignType.Center, value_types_1.AlignType.Right, value_types_1.AlignType.Justify, value_types_1.AlignType.Left], function (a) { return a === align; })) {\n            cleanAttrs.align = align;\n        }\n        if (direction === value_types_1.DirectionType.Rtl) {\n            cleanAttrs.direction = direction;\n        }\n        if (indent && Number(indent)) {\n            cleanAttrs.indent = Math.min(Number(indent), 30);\n        }\n        if (mentions && mention) {\n            var sanitizedMention = MentionSanitizer_1.MentionSanitizer.sanitize(mention, sanitizeOptions);\n            if (Object.keys(sanitizedMention).length > 0) {\n                cleanAttrs.mentions = !!mentions;\n                cleanAttrs.mention = mention;\n            }\n        }\n        return Object.keys(dirtyAttrs).reduce(function (cleaned, k) {\n            if (sanitizedAttrs.indexOf(k) === -1) {\n                cleaned[k] = dirtyAttrs[k];\n            }\n            return cleaned;\n        }, cleanAttrs);\n    };\n    OpAttributeSanitizer.sanitizeLinkUsingOptions = function (link, options) {\n        var sanitizerFn = function () {\n            return undefined;\n        };\n        if (options && typeof options.urlSanitizer === 'function') {\n            sanitizerFn = options.urlSanitizer;\n        }\n        var result = sanitizerFn(link);\n        return typeof result === 'string' ? result : funcs_html_1.encodeLink(url.sanitize(link));\n    };\n    OpAttributeSanitizer.IsValidHexColor = function (colorStr) {\n        return !!colorStr.match(/^#([0-9A-F]{6}|[0-9A-F]{3})$/i);\n    };\n    OpAttributeSanitizer.IsValidColorLiteral = function (colorStr) {\n        return !!colorStr.match(/^[a-z]{1,50}$/i);\n    };\n    OpAttributeSanitizer.IsValidRGBColor = function (colorStr) {\n        var re = /^rgb\\(((0|25[0-5]|2[0-4]\\d|1\\d\\d|0?\\d?\\d),\\s*){2}(0|25[0-5]|2[0-4]\\d|1\\d\\d|0?\\d?\\d)\\)$/i;\n        return !!colorStr.match(re);\n    };\n    OpAttributeSanitizer.IsValidFontName = function (fontName) {\n        return !!fontName.match(/^[a-z\\s0-9\\- ]{1,30}$/i);\n    };\n    OpAttributeSanitizer.IsValidSize = function (size) {\n        return !!size.match(/^[a-z0-9\\-]{1,20}$/i);\n    };\n    OpAttributeSanitizer.IsValidWidth = function (width) {\n        return !!width.match(/^[0-9]*(px|em|%)?$/);\n    };\n    OpAttributeSanitizer.isValidTarget = function (target) {\n        return !!target.match(/^[_a-zA-Z0-9\\-]{1,50}$/);\n    };\n    OpAttributeSanitizer.IsValidRel = function (relStr) {\n        return !!relStr.match(/^[a-zA-Z\\s\\-]{1,250}$/i);\n    };\n    OpAttributeSanitizer.IsValidLang = function (lang) {\n        if (typeof lang === 'boolean') {\n            return true;\n        }\n        return !!lang.match(/^[a-zA-Z\\s\\-\\\\\\/\\+]{1,50}$/i);\n    };\n    return OpAttributeSanitizer;\n}());\nexports.OpAttributeSanitizer = OpAttributeSanitizer;\n"]},"metadata":{},"sourceType":"script"}